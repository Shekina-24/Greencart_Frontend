(()=>{var e={};e.id=375,e.ids=[375],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5203:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(7595),t(8242),t(5866);var a=t(3191),s=t(8716),n=t(7922),i=t.n(n),l=t(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(r,d);let o=["",{children:["admin",{children:["reports",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7595)),"C:\\New\\Greencart\\Greencart\\app\\admin\\reports\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8242)),"C:\\New\\Greencart\\Greencart\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\New\\Greencart\\Greencart\\app\\admin\\reports\\page.tsx"],p="/admin/reports/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/reports/page",pathname:"/admin/reports",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},7451:(e,r,t)=>{Promise.resolve().then(t.bind(t,9660))},9660:(e,r,t)=>{"use strict";t.d(r,{default:()=>p});var a=t(326),s=t(7577),n=t(434),i=t(8358),l=t(3391),d=t(6824),o=t(2531);function c(){let{user:e}=(0,i.a)(),[r,t]=(0,s.useState)(null),[o,c]=(0,s.useState)([]),[p,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!1),[h,g]=(0,s.useState)(""),[v,j]=(0,s.useState)(""),y=(0,d.r)(),f=async()=>{try{let e=(0,l.Z6)();if(!e)return;let r=new URLSearchParams;h&&r.set("period_start",h),v&&r.set("period_end",v),await (0,d.S)(`/admin/reports/generate?${r.toString()}`,{method:"POST",authToken:e.accessToken});let[a,s]=await Promise.all([(0,d.S)("/admin/reports/summary",{authToken:e.accessToken,params:{period_start:h||void 0,period_end:v||void 0}}),(0,d.S)("/admin/reports/files",{authToken:e.accessToken})]);t(a),c(s.items)}catch(e){u("Echec de la g\xe9n\xe9ration du rapport.")}};return(0,a.jsxs)("main",{className:"container",style:{display:"grid",gap:"var(--space-12)"},children:[(0,a.jsxs)("nav",{"aria-label":"Fil d'ariane",style:{fontSize:"var(--fs-small)"},children:[a.jsx(n.default,{className:"muted",href:"/",children:"Accueil"})," / Admin / Rapports"]}),a.jsx("section",{className:"section",children:(0,a.jsxs)("div",{style:{display:"grid",gap:"var(--space-3)"},children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"badge badge--impact",children:"Administration"}),a.jsx("h1",{style:{marginTop:"var(--space-2)"},children:"Rapports"}),a.jsx("p",{className:"muted",children:"Consultez le r\xe9sum\xe9 des ventes et t\xe9l\xe9chargez les rapports g\xe9n\xe9r\xe9s."})]}),p?a.jsx("div",{className:"alert alert--warning",children:p}):null,m?a.jsx("p",{className:"muted",children:"Chargement..."}):(0,a.jsxs)(a.Fragment,{children:[r?(0,a.jsxs)("div",{className:"card",style:{gap:"var(--space-2)"},children:[a.jsx("strong",{children:"P\xe9riode"}),(0,a.jsxs)("div",{className:"muted",style:{fontSize:"var(--fs-small)"},children:[new Date(r.period_start).toLocaleDateString("fr-FR")," â†’ ",new Date(r.period_end).toLocaleDateString("fr-FR")]}),(0,a.jsxs)("div",{style:{display:"grid",gap:"var(--space-1)"},children:[(0,a.jsxs)("div",{children:["Total commandes: ",r.total_orders]}),(0,a.jsxs)("div",{children:["Revenu total (centimes): ",r.total_revenue_cents]}),(0,a.jsxs)("div",{children:["Articles vendus: ",r.total_items_sold]}),(0,a.jsxs)("div",{children:["Panier moyen (centimes): ",r.average_order_value_cents]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",alignItems:"center",marginTop:"8px"},children:[a.jsx("input",{className:"input",type:"date",value:h,onChange:e=>g(e.target.value)}),a.jsx("input",{className:"input",type:"date",value:v,onChange:e=>j(e.target.value)}),a.jsx("button",{className:"btn btn--primary",type:"button",onClick:f,children:"G\xe9n\xe9rer & actualiser"})]})]}):null,(0,a.jsxs)("div",{className:"card",style:{gap:"var(--space-2)"},children:[a.jsx("strong",{children:"Fichiers disponibles"}),0===o.length?a.jsx("p",{className:"muted",children:"Aucun rapport g\xe9n\xe9r\xe9 pour le moment."}):a.jsx("div",{className:"grid",style:{gap:"var(--space-2)"},children:o.map(e=>{var r;return(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:"var(--space-2)"},children:[(0,a.jsxs)("div",{children:[a.jsx("div",{children:e.name}),(0,a.jsxs)("div",{className:"muted",style:{fontSize:"var(--fs-small)"},children:[e.format.toUpperCase()," \xb7 ",(r=e.size_bytes)<1024?`${r} B`:r<1048576?`${(r/1024).toFixed(1)} KB`:`${(r/1048576).toFixed(1)} MB`]})]}),a.jsx("a",{className:"btn btn--ghost",href:`${y}${e.url}`,target:"_blank",rel:"noreferrer",children:"T\xe9l\xe9charger"})]},e.name)})})]})]})]})})]})}function p(){return a.jsx(o.Z,{requireAuth:!0,requiredRole:"admin",children:()=>a.jsx(c,{})})}},7595:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i,metadata:()=>n});var a=t(9510);let s=(0,t(8570).createProxy)(String.raw`C:\New\Greencart\Greencart\components\AdminReportsPage.tsx#default`),n={title:"Admin \xb7 Rapports | GreenCart",description:"Rapports de ventes et t\xe9l\xe9chargements."};function i(){return a.jsx(s,{})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,772,404,424,526,531],()=>t(5203));module.exports=a})();