(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[591],{3356:function(e,s,n){Promise.resolve().then(n.bind(n,7689))},7689:function(e,s,n){"use strict";n.d(s,{default:function(){return d}});var a=n(7437),i=n(2265),t=n(8822),l=n(9116),c=n(1741);function r(){var e;let[s,n]=(0,i.useState)([]),[c,r]=(0,i.useState)(null),[d,o]=(0,i.useState)(null),[m,u]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=(0,t.Z6)();e&&(u(!0),o(null),Promise.all([(0,l.S)("/producer/recommendations/forecast",{authToken:e.accessToken}),(0,l.S)("/producer/recommendations/segments",{authToken:e.accessToken})]).then(e=>{let[s,a]=e;n(s.items),r(a)}).catch(()=>o("Impossible de charger les recommandations.")).finally(()=>u(!1)))},[]),(0,a.jsx)("main",{className:"container",style:{display:"grid",gap:"var(--space-12)"},children:(0,a.jsx)("section",{className:"section",children:(0,a.jsxs)("div",{style:{display:"grid",gap:"var(--space-3)"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"badge badge--impact",children:"Espace producteur"}),(0,a.jsx)("h1",{style:{marginTop:"var(--space-2)"},children:"Recommandations IA"}),(0,a.jsx)("p",{className:"muted",children:"Pr\xe9visions hebdomadaires basiques et segmentation clients (K‑means)."})]}),d?(0,a.jsx)("div",{className:"alert alert--warning",children:d}):null,m?(0,a.jsx)("p",{className:"muted",children:"Chargement..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"card",style:{display:"grid",gap:8},children:[(0,a.jsx)("strong",{children:"Pr\xe9visions (moyenne mobile)"}),0===s.length?(0,a.jsx)("p",{className:"muted",children:"Aucun historique."}):(0,a.jsx)("div",{className:"grid",style:{gap:8},children:s.slice(0,8).map(e=>(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,a.jsx)("span",{children:e.title}),(0,a.jsxs)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:["moy. hebdo: ",e.avg_weekly_units," • prochaine 4 sem.: ",e.forecast_next_weeks.join(", ")]})]},e.product_id))})]}),(0,a.jsxs)("div",{className:"card",style:{display:"grid",gap:8},children:[(0,a.jsxs)("strong",{children:["Segments clients (K = ",null!==(e=null==c?void 0:c.k)&&void 0!==e?e:0,")"]}),c?(0,a.jsx)("div",{className:"grid",style:{gap:8},children:c.centroids.map((e,s)=>(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsxs)("span",{children:["Segment #",s+1]}),(0,a.jsxs)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:[c.counts[s]," clients • AOV ~ ",(e.aov_cents/100).toFixed(2)," EUR • ",e.avg_items," items/commande"]})]},s))}):(0,a.jsx)("p",{className:"muted",children:"—"})]})]})]})})})}function d(){return(0,a.jsx)(c.Z,{requireAuth:!0,requiredRole:"producer",children:()=>(0,a.jsx)(r,{})})}}},function(e){e.O(0,[972,697,741,971,117,744],function(){return e(e.s=3356)}),_N_E=e.O()}]);