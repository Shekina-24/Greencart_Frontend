(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[865],{6938:function(e,t,s){Promise.resolve().then(s.bind(s,5766))},5766:function(e,t,s){"use strict";s.d(t,{default:function(){return u}});var r=s(7437),i=s(2265),a=s(8822),n=s(6144),l=s(4730),c=s(1741);function o(e){return"".concat((e/100).toFixed(2)," EUR")}function d(){let{user:e}=(0,l.a)(),[t,s]=(0,i.useState)(null),[c,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!e)return;let t=(0,a.Z6)();t&&(d(!0),m(null),(0,n.VP)(t.accessToken).then(s).catch(()=>m("Impossible de charger les statistiques producteur.")).finally(()=>d(!1)))},[e]),(0,r.jsx)("main",{className:"container",style:{display:"grid",gap:"var(--space-12)"},children:(0,r.jsx)("section",{className:"section",children:(0,r.jsxs)("div",{style:{display:"grid",gap:"var(--space-3)"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"badge badge--impact",children:"Espace producteur"}),(0,r.jsx)("h1",{style:{marginTop:"var(--space-2)"},children:"Tableau de bord"}),(0,r.jsx)("p",{className:"muted",children:"Suivi des ventes, unit\xe9s vendues et impact."})]}),u?(0,r.jsx)("div",{className:"alert alert--warning",children:u}):null,c||!t?(0,r.jsx)("p",{className:"muted",children:"Chargement..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid",style:{gap:"var(--space-3)",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[(0,r.jsxs)("article",{className:"card",style:{gap:"var(--space-1)"},children:[(0,r.jsx)("strong",{children:t.totalOrders}),(0,r.jsx)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:"Commandes"})]}),(0,r.jsxs)("article",{className:"card",style:{gap:"var(--space-1)"},children:[(0,r.jsx)("strong",{children:t.totalItemsSold}),(0,r.jsx)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:"Unit\xe9s vendues"})]}),(0,r.jsxs)("article",{className:"card",style:{gap:"var(--space-1)"},children:[(0,r.jsx)("strong",{children:o(t.totalRevenueCents)}),(0,r.jsx)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:"Chiffre d'affaires"})]}),(0,r.jsxs)("article",{className:"card",style:{gap:"var(--space-1)"},children:[(0,r.jsx)("strong",{children:o(t.averageOrderValueCents)}),(0,r.jsx)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:"Panier moyen"})]}),(0,r.jsxs)("article",{className:"card",style:{gap:"var(--space-1)"},children:[(0,r.jsxs)("strong",{children:[(t.totalImpactCo2Grams/1e3).toFixed(1)," kg CO2e"]}),(0,r.jsx)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:"Impact \xe9vit\xe9"})]})]}),(0,r.jsxs)("div",{className:"card",style:{gap:"var(--space-2)"},children:[(0,r.jsx)("strong",{children:"Top produits"}),0===t.topProducts.length?(0,r.jsx)("p",{className:"muted",children:"Aucun produit en t\xeate pour le moment."}):(0,r.jsx)("div",{className:"grid",style:{gap:"var(--space-1)"},children:t.topProducts.map(e=>(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:e.title}),(0,r.jsxs)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:[e.unitsSold," unit\xe9s â€¢ ",(e.revenueCents/100).toFixed(2)," EUR"]})]},e.productId))})]})]})]})})})}function u(){return(0,r.jsx)(c.Z,{requireAuth:!0,requiredRole:"producer",children:()=>(0,r.jsx)(d,{})})}},6144:function(e,t,s){"use strict";s.d(t,{Au:function(){return d},J8:function(){return l},VP:function(){return a},et:function(){return c},sJ:function(){return n},ud:function(){return o}});var r=s(9116),i=s(2139);async function a(e){let t=await (0,r.S)("/producer/insights",{authToken:e});return{totalOrders:t.total_orders,totalRevenueCents:t.total_revenue_cents,totalItemsSold:t.total_items_sold,averageOrderValueCents:t.average_order_value_cents,totalImpactCo2Grams:t.total_impact_co2_g,topProducts:t.top_products.map(e=>{var t;return{productId:e.product_id,title:e.title,revenueCents:e.revenue_cents,unitsSold:e.units_sold,averageRating:null!==(t=e.average_rating)&&void 0!==t?t:null}})}}async function n(e){var t,s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await (0,r.S)("/producer/products",{authToken:e,params:{limit:null!==(t=a.limit)&&void 0!==t?t:20,offset:null!==(s=a.offset)&&void 0!==s?s:0}});return{items:n.items.map(i.fm),total:n.total,limit:n.limit,offset:n.offset}}async function l(e,t){var s,a,n,l,c,o,d,u,m;let p={title:t.title,price_cents:t.priceCents,stock:t.stock,description:null!==(s=t.description)&&void 0!==s?s:null,category:null!==(a=t.category)&&void 0!==a?a:null,region:null!==(n=t.region)&&void 0!==n?n:null,origin:null!==(l=t.origin)&&void 0!==l?l:null,dlc_date:null!==(c=t.dlcDate)&&void 0!==c?c:null,impact_co2_g:null!==(o=t.impactCo2Grams)&&void 0!==o?o:null,promo_price_cents:null!==(d=t.promoPriceCents)&&void 0!==d?d:null,is_published:null!==(u=t.isPublished)&&void 0!==u&&u,images:(null!==(m=t.images)&&void 0!==m?m:[]).map(e=>({url:e.url,is_primary:!!e.isPrimary}))};t.status&&(p.status=t.status);let v=await (0,r.S)("/products",{method:"POST",authToken:e,body:JSON.stringify(p)});return(0,i.fm)(v)}async function c(e,t,s){let a={};void 0!==s.title&&(a.title=s.title),void 0!==s.description&&(a.description=s.description),void 0!==s.category&&(a.category=s.category),void 0!==s.region&&(a.region=s.region),void 0!==s.origin&&(a.origin=s.origin),void 0!==s.dlcDate&&(a.dlc_date=s.dlcDate),void 0!==s.impactCo2Grams&&(a.impact_co2_g=s.impactCo2Grams),void 0!==s.priceCents&&(a.price_cents=s.priceCents),void 0!==s.promoPriceCents&&(a.promo_price_cents=s.promoPriceCents),void 0!==s.stock&&(a.stock=s.stock),void 0!==s.status&&(a.status=s.status),void 0!==s.isPublished&&(a.is_published=s.isPublished);let n=await (0,r.S)("/producer/products/".concat(t),{method:"PUT",authToken:e,body:JSON.stringify(a)});return(0,i.fm)(n)}async function o(e,t){await (0,r.S)("/producer/products/".concat(t),{method:"DELETE",authToken:e})}async function d(e){var t,s;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await (0,r.S)("/producer/orders",{authToken:e,params:{limit:null!==(t=i.limit)&&void 0!==t?t:20,offset:null!==(s=i.offset)&&void 0!==s?s:0}});return{items:a.items.map(e=>({orderId:e.order_id,status:e.status,customerId:e.customer_id,customerEmail:e.customer_email,createdAt:e.created_at,totalAmountCents:e.total_amount_cents,lines:e.lines.map(e=>{var t;return{id:e.id,orderId:e.order_id,productId:e.product_id,productTitle:e.product_title,quantity:e.quantity,unitPriceCents:e.unit_price_cents,referencePriceCents:null!==(t=e.reference_price_cents)&&void 0!==t?t:null,subtotalCents:e.subtotal_cents,createdAt:e.created_at}})})),total:a.total,limit:a.limit,offset:a.offset}}}},function(e){e.O(0,[972,697,741,971,117,744],function(){return e(e.s=6938)}),_N_E=e.O()}]);