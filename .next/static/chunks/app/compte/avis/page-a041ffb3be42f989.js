(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[85],{2709:function(e,t,s){Promise.resolve().then(s.bind(s,6390))},6390:function(e,t,s){"use strict";s.d(t,{default:function(){return d}});var i=s(7437),n=s(2265),a=s(4730),r=s(8822),l=s(3627),c=s(1741);function o(){let{user:e}=(0,a.a)(),[t,s]=(0,n.useState)([]),[c,o]=(0,n.useState)(!1),[d,u]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(!e)return;let t=(0,r.Z6)();t&&(o(!0),u(null),(0,l.qB)(t.accessToken).then(e=>s(e.items)).catch(()=>u("Impossible de recuperer vos avis.")).finally(()=>o(!1)))},[e]),(0,i.jsx)("main",{className:"container",style:{display:"grid",gap:"var(--space-12)"},children:(0,i.jsx)("section",{className:"section",children:(0,i.jsxs)("div",{style:{display:"grid",gap:"var(--space-3)"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"badge badge--impact",children:"Mon compte"}),(0,i.jsx)("h1",{style:{marginTop:"var(--space-2)"},children:"Mes avis"}),(0,i.jsx)("p",{className:"muted",children:"Historique de vos avis laisses sur les produits."})]}),d?(0,i.jsx)("div",{className:"alert alert--warning",children:d}):null,c?(0,i.jsx)("p",{className:"muted",children:"Chargement..."}):0===t.length?(0,i.jsx)("p",{className:"muted",children:"Vous n'avez pas encore laisse d'avis."}):(0,i.jsx)("div",{className:"grid",style:{gap:"var(--space-3)"},children:t.map(e=>(0,i.jsxs)("article",{className:"card",style:{gap:"var(--space-2)"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsxs)("strong",{children:["Note ",e.rating,"/5"]}),(0,i.jsx)("span",{className:"muted",style:{fontSize:"var(--fs-small)"},children:new Date(e.createdAt).toLocaleDateString("fr-FR")})]}),e.comment?(0,i.jsx)("p",{children:e.comment}):(0,i.jsx)("p",{className:"muted",children:"Sans commentaire"}),(0,i.jsxs)("div",{className:"muted",style:{fontSize:"var(--fs-small)"},children:["Statut: ",e.status]})]},e.id))})]})})})}function d(){return(0,i.jsx)(c.Z,{requireAuth:!0,children:()=>(0,i.jsx)(o,{})})}},3627:function(e,t,s){"use strict";s.d(t,{O:function(){return n},XU:function(){return a},g8:function(){return r},i0:function(){return l},qB:function(){return c}});var i=s(9116);async function n(e){var t,s;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await (0,i.S)("/reviews/product/".concat(e),{params:{limit:null!==(t=n.limit)&&void 0!==t?t:20,offset:null!==(s=n.offset)&&void 0!==s?s:0}});return{items:a.items.map(o),total:a.total,limit:a.limit,offset:a.offset}}async function a(e,t){var s,n;return o(await (0,i.S)("/reviews",{method:"POST",body:JSON.stringify({product_id:e.product_id,rating:e.rating,comment:null!==(s=e.comment)&&void 0!==s?s:null,order_id:null!==(n=e.order_id)&&void 0!==n?n:null}),authToken:t}))}async function r(e,t,s){var n,a;return o(await (0,i.S)("/reviews/".concat(e),{method:"PATCH",body:JSON.stringify({product_id:t.product_id,rating:t.rating,comment:null!==(n=t.comment)&&void 0!==n?n:null,order_id:null!==(a=t.order_id)&&void 0!==a?a:null}),authToken:s}))}async function l(e,t){await (0,i.S)("/reviews/".concat(e),{method:"DELETE",authToken:t})}async function c(e){var t,s;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await (0,i.S)("/reviews/me",{authToken:e,params:{limit:null!==(t=n.limit)&&void 0!==t?t:20,offset:null!==(s=n.offset)&&void 0!==s?s:0}});return{items:a.items.map(o),total:a.total,limit:a.limit,offset:a.offset}}function o(e){return{id:e.id,productId:e.product_id,userId:e.user_id,rating:e.rating,comment:e.comment,status:e.status,createdAt:e.created_at,publishedAt:e.published_at,moderationNotes:e.moderation_notes}}}},function(e){e.O(0,[972,697,741,971,117,744],function(){return e(e.s=2709)}),_N_E=e.O()}]);